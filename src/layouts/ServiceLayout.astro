---
import Layout from '~/layouts/Layout.astro';
import Header from '~/components/widgets/Header.astro';
import Footer from '~/components/widgets/Footer.astro';
import Announcement from '~/components/widgets/Announcement.astro';

import { headerData, footerData } from '~/navigation';
import { getCityBySlug } from '~/data/locations';

import type { MetaData } from '~/types';

export interface Props {
  metadata?: MetaData;
  title: string;
  description: string;
  keywords?: string[];
  city?: string;
  service?: string;
}

const { metadata, title, description, keywords, city, service } = Astro.props;

// Get city information if provided
const cityInfo = city ? getCityBySlug(city) : null;

// Create enhanced metadata for SEO
const enhancedMetadata: MetaData = {
  title: cityInfo ? `${title} في ${cityInfo.nameArabic}` : title,
  description: cityInfo ? `${description} في ${cityInfo.nameArabic} - خدمات عالية الجودة` : description,
  keywords: keywords?.join(', '),
  ...metadata,
};
---

<Layout metadata={enhancedMetadata}>
  <slot name="announcement">
    <Announcement />
  </slot>
  <slot name="header">
    <Header {...headerData} isSticky showRssFeed showToggleTheme />
  </slot>
  <main class="rtl:text-right">
    <!-- Breadcrumb Navigation -->
    <div class="bg-gray-50 dark:bg-gray-900 py-4">
      <div class="container mx-auto px-4">
        <nav class="text-sm" aria-label="Breadcrumb">
          <ol class="flex items-center space-x-2 rtl:space-x-reverse">
            <li>
              <a href="/" class="text-primary hover:text-primary/80">الرئيسية</a>
            </li>
            {cityInfo && (
              <>
                <span class="text-gray-400">›</span>
                <li>
                  <a href={`/sa/${city}`} class="text-primary hover:text-primary/80">
                    {cityInfo.nameArabic}
                  </a>
                </li>
              </>
            )}
            {service && (
              <>
                <span class="text-gray-400">›</span>
                <li class="text-gray-600 dark:text-gray-400">{title}</li>
              </>
            )}
          </ol>
        </nav>
      </div>
    </div>

    <!-- Service Content -->
    <div class="container mx-auto px-4 py-8">
      <div class="max-w-4xl mx-auto">
        <!-- Service Header -->
        <header class="mb-8 text-center">
          <h1 class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4">
            {cityInfo ? `${title} في ${cityInfo.nameArabic}` : title}
          </h1>
          <p class="text-xl text-gray-600 dark:text-gray-300 leading-relaxed">
            {description}
          </p>
        </header>

        <!-- Service Content Slot -->
        <div class="prose prose-lg max-w-none dark:prose-invert rtl:text-right">
          <slot />
        </div>

        <!-- Contact CTA -->
        <div class="mt-12 bg-primary/5 rounded-lg p-8 text-center">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
            احصل على خدمة فورية
          </h3>
          <p class="text-gray-600 dark:text-gray-300 mb-6">
            اتصل بنا الآن للحصول على استشارة مجانية وعرض سعر مخصص
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a 
              href="tel:+966123456789" 
              class="bg-primary text-white px-8 py-3 rounded-lg font-semibold hover:bg-primary/90 transition-colors"
            >
              اتصل الآن: 123-456-789
            </a>
            <a 
              href="https://wa.me/966123456789" 
              class="bg-green-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors"
            >
              واتساب
            </a>
          </div>
        </div>
      </div>
    </div>
  </main>
  <slot name="footer">
    <Footer {...footerData} />
  </slot>
</Layout>